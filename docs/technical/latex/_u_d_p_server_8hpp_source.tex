\doxysection{UDPServer.\+hpp}
\hypertarget{_u_d_p_server_8hpp_source}{}\label{_u_d_p_server_8hpp_source}\index{/Users/xavierv/Developer/EPITECH/R-\/Type/server/include/UDPServer.hpp@{/Users/xavierv/Developer/EPITECH/R-\/Type/server/include/UDPServer.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ Created\ by\ Xavier\ VINCENT\ on\ 13/12/2023.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}RTypeNetwork.hpp"{}}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00017\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_timed_message}{TimedMessage}}\ \{}
\DoxyCodeLine{00018\ \ \ \mbox{\hyperlink{struct_message}{Message}}\ *\mbox{\hyperlink{struct_timed_message_a2c1d25c80436512087308a036f01e86a}{message}};\ }
\DoxyCodeLine{00019\ \ \ std::chrono::high\_resolution\_clock::time\_point}
\DoxyCodeLine{00020\ \ \ \ \ \mbox{\hyperlink{struct_timed_message_abd5fd4e205672e1fdd572a47e7736e67}{timestamp}};\ }
\DoxyCodeLine{00021\ \};}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{keyword}{namespace\ }Network}
\DoxyCodeLine{00024\ \{}
\DoxyCodeLine{00033\ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_network_1_1_u_d_p_server}{UDPServer}}\ \{}
\DoxyCodeLine{00034\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00045\ \ \ \ \ \mbox{\hyperlink{class_network_1_1_u_d_p_server}{UDPServer}}(boost::asio::io\_context\ \&io);}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00059\ \ \ \ \ \mbox{\hyperlink{class_network_1_1_u_d_p_server}{UDPServer}}(boost::asio::io\_context\ \&io,\ \textcolor{keywordtype}{int}\ port);}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00067\ \ \ \ \ \mbox{\hyperlink{class_network_1_1_u_d_p_server_a6ae6efb6b05e6b6518195512e90a216d}{\string~UDPServer}}();}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00077\ \ \ \ \ boost::asio::ip::udp::socket\ \&\mbox{\hyperlink{class_network_1_1_u_d_p_server_ac32cc82757d28952e4429a16189b4216}{getSocket}}();}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00087\ \ \ \ \ std::vector<Network::Client>\ \&\mbox{\hyperlink{class_network_1_1_u_d_p_server_a6577105fddee863d8d7bbae6f7bac2f7}{getClients}}();}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00097\ \ \ \ \ boost::array<char,\ 1024>\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_a2009531677d046860f0c67ff3e32d03f}{getRecvBuffer}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00108\ \ \ \ \ boost::asio::ip::udp::endpoint\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_a9f7a52213bf27b1cd095cf526d6736ac}{getRemoteEndpoint}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00118\ \ \ \ \ std::vector<Network::Room>\ \&\mbox{\hyperlink{class_network_1_1_u_d_p_server_a421b82239515eafa196dc68cc573fc2b}{getRooms}}();}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_abdff6274a3af6cd99c418197c4630a75}{addClient}}(\mbox{\hyperlink{class_network_1_1_client}{Network::Client}}\ client);}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_a8d43c1630c01f9eefa4909772057e9c8}{initServer}}(\textcolor{keywordtype}{int}\ port);}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_ac4b4c1cd19635deb604ceb2a63839f4d}{initRooms}}(\textcolor{keywordtype}{int}\ count);}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_ac2a6fa9962f244fd7ba8578d89296874}{startReceive}}();}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00162\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_ac97d512d745687229613d23b27a71bae}{handleReceive}}(}
\DoxyCodeLine{00163\ \ \ \ \ \ \ boost::system::error\_code\ \textcolor{keyword}{const}\ \&error,}
\DoxyCodeLine{00164\ \ \ \ \ \ \ std::size\_t\ bytes\_transferred);}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00173\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_ac811ac0c540ab08eeb7fd4002e4af9d4}{sendToAll}}(boost::asio::const\_buffer\ \textcolor{keyword}{const}\ \&buffer);}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00185\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_a9a296cd50ace6d20256e4a94290bf1b4}{sendToAllClientsInRoom}}(}
\DoxyCodeLine{00186\ \ \ \ \ \ \ boost::asio::const\_buffer\ \textcolor{keyword}{const}\ \&buffer,}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ roomId);}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00198\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_a9c2f0877b54c60de4ca0a2d21696ba93}{sendToClient}}(boost::asio::const\_buffer\ \textcolor{keyword}{const}\ \&buffer,\ \textcolor{keywordtype}{int}\ \textcolor{keywordtype}{id});}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_ad31c0be7001a0123b1fe8434161665de}{processMessage}}(\mbox{\hyperlink{struct_timed_message}{TimedMessage}}\ message);}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_a16bd0e5a013230d835b30a3b0cfd86d9}{processResponse}}(\mbox{\hyperlink{struct_response}{Response}}\ *response);}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_aabec654d8576481b31d0c1e689b66699}{workerFunction}}();}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00242\ \ \ \ \ std::vector<char>\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_ae39c8403eb951167f8b1255efad19880}{createResponseBuffer}}(}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ clientId,}
\DoxyCodeLine{00244\ \ \ \ \ \ \ std::string\ \textcolor{keyword}{const}\ \&command,}
\DoxyCodeLine{00245\ \ \ \ \ \ \ std::string\ \textcolor{keyword}{const}\ \&statusMessage,}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ \textcolor{keyword}{const}\ data[]\ =\ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ dataSize\ =\ 0,}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ status\ =\ RES\_SUCCESS);}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00260\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_ae6df6365d9c49e58434876ef104817a9}{sendResponseAndLog}}(}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \mbox{\hyperlink{struct_timed_message}{TimedMessage}}\ timedMessage,}
\DoxyCodeLine{00262\ \ \ \ \ \ \ std::vector<char>\ responseBuffer);}
\DoxyCodeLine{00263\ }
\DoxyCodeLine{00274\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_ab2d04421510f1fd72b2158aa171241e9}{isClientRegistered}}(\textcolor{keywordtype}{int}\ clientId);}
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00285\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_a2db9f8510e50ae6dcf8d13f68bd97668}{isClientConnected}}(\textcolor{keywordtype}{int}\ clientId);}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00292\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_a645d58ffa062a8bcab8450c04a1b30a7}{startCheckClientsConnectionTimer}}();}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00299\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_a969806b68815385e196569f31d66a3a4}{checkClients}}();}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00308\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_network_1_1_u_d_p_server_a82f424a15da216aade28273353dad9eb}{registerCommandHandlers}}();}
\DoxyCodeLine{00309\ }
\DoxyCodeLine{00310\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00311\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00312\ \ \ \ \ boost::asio::ip::udp::socket\ socket;\ \ \ \ }
\DoxyCodeLine{00313\ \ \ \ \ std::vector<Network::Client>\ clients;\ \ \ }
\DoxyCodeLine{00314\ \ \ \ \ boost::array<char,\ 1024>\ recvBuffer\ \{\};\ }
\DoxyCodeLine{00315\ \ \ \ \ boost::asio::ip::udp::endpoint}
\DoxyCodeLine{00316\ \ \ \ \ \ \ remoteEndpoint;\ }
\DoxyCodeLine{00317\ \ \ \ \ \mbox{\hyperlink{class_network_1_1_thread_safe_queue}{Network::ThreadSafeQueue<TimedMessage>}}}
\DoxyCodeLine{00318\ \ \ \ \ \ \ messageQueue;\ }
\DoxyCodeLine{00319\ \ \ \ \ std::vector<std::thread>}
\DoxyCodeLine{00320\ \ \ \ \ \ \ workers;\ }
\DoxyCodeLine{00321\ \ \ \ \ std::vector<Network::Room>\ rooms;\ }
\DoxyCodeLine{00322\ \ \ \ \ std::unordered\_map<std::string,\ std::unique\_ptr<ICommandHandler>>}
\DoxyCodeLine{00323\ \ \ \ \ \ \ commandHandlers;\ }
\DoxyCodeLine{00324\ \ \ \ \ boost::asio::steady\_timer}
\DoxyCodeLine{00325\ \ \ \ \ \ \ clientsConnectionTimer;\ }
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00327\ \ \ \ \ \textcolor{keywordtype}{void}\ handleInvalidClient(}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \mbox{\hyperlink{struct_timed_message}{TimedMessage}}\ timedMessage);\ }
\DoxyCodeLine{00329\ \ \ \ \ \textcolor{keywordtype}{void}\ handleInvalidCommand(}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \mbox{\hyperlink{struct_timed_message}{TimedMessage}}\ timedMessage);\ }
\DoxyCodeLine{00331\ \ \ \};}
\DoxyCodeLine{00332\ \}\ \textcolor{comment}{//\ namespace\ Network}}

\end{DoxyCode}
